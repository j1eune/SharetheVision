<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="msMapper">

	<resultMap type="Member" id="MemberResultMap">
		<id column="M_CODE" property="mCode"/>
		<result column="M_NAME" property="name"/>
		<result column="M_ID" property="mId"/>
		<result column="DEPT_NO" property="deptNo"/>
		<result column="DEPT_NAME" property="deptName"/>
		<result column="J_NAME" property="jobName"/>
	</resultMap>
	
	<select id="toList" resultMap="MemberResultMap">
	   SELECT M_CODE, M_NAME, M_ID, DEPT_NO, DEPT_NAME, J_NAME, J_NO
	     FROM MEMBER
	     JOIN DEPARTMENT USING(DEPT_NO)
	     JOIN JOB USING(J_NO)
		WHERE M_STATUS='Y'
	 ORDER BY J_NO ASC
	</select>

	<select id="RoomList" resultMap="RoomResultMap">
		SELECT *
		  FROM ROOM
		 WHERE FID = #{fid}
		   AND RSTA ='Y'
		 ORDER BY RNO DESC
	</select>
 	<resultMap  type="Room" id="RoomResultMap">
		    <id column="RNO" property="rno"/>
		<result column="FID" property="fid"/>
		<result column="TID" property="tid"/>
		<result column="RSTA" property="rsta"/>
	</resultMap> 
	
	<select id="selectList" resultMap="MsResultMap">
	   SELECT *
		 FROM MS
	    WHERE EMO=#{roomId}
	</select>
	<resultMap  type="Messenger" id="MsResultMap">
		    <id column="MS_NO" property="ms_no"/>
		<result column="MS_CONTENT" property="ms_content"/>
		<result column="MS_TIME" property="ms_time"/>
		<result column="EMO" property="emo"/>
		<result column="MS_FILE" property="ms_file"/>
		<result column="M_CODE" property="m_code"/>
		<result column="M_CODE2" property="m_code2"/>
	</resultMap>
	
	<select id="existRoom" resultMap="RoomResultMap">
		SELECT *
		  FROM ROOM
		 WHERE FID IN (#{fid},#{tid}) 
		   AND TID IN (#{tid},#{fid})
		   AND RSTA='Y'
	</select>
	
	<insert id="insertRoom">
		INSERT INTO ROOM
		VALUES (SEQ_RNO.NEXTVAL, #{fid}, #{tid}, DEFAULT)
	</insert>
	
</mapper>
